import{c as N,u as A,r as o,A as u,j as e,b as k,H as j,L as p}from"./index-7DfaYbEJ.js";import{a as f}from"./index-B9ygI19o.js";import{R as w}from"./RatingStars-DqI9rlye.js";import{A as E,b as $,C as R}from"./seo--YsTHAzJ.js";const b="/images/default-cover.jpg";function _({isAdmin:y}){const{slug:l}=N(),r=A(),[t,d]=o.useState(r.state?.article||null),[v,m]=o.useState(0);if(o.useEffect(()=>{if(window.scrollTo({top:0}),r.state?.article){d(r.state.article);return}f.get(`${u}/posts/${l}`).then(s=>{const c=s.data;c&&typeof c=="object"&&c.slug?d(c):(console.error("❌ Invalid article payload:",c),d(null))}).catch(s=>{console.error("❌ Article fetch error:",s),d(null)})},[l,r.state]),o.useEffect(()=>{l&&f.get(`${u}/ratings?slug=${l}`).then(s=>{typeof s.data?.rating=="number"&&m(s.data.rating)}).catch(()=>{})},[l]),o.useEffect(()=>{m(Number(localStorage.getItem(`rating-${l}`))||0)},[l]),!t)return e.jsx(E,{});const g=!!t.external,i=$({title:t.title,description:t.excerpt||t.content?.replace(/<[^>]+>/g,"").slice(0,160),image:k(t.cover,b),url:`${window.location.origin}/article/${t.slug}`}),a=r.state?.allArticles||[],n=a.findIndex(s=>s.slug===t.slug),x=n>0?a[n-1]:null,h=n!==-1&&n<a.length-1?a[n+1]:null;return e.jsxs(e.Fragment,{children:[e.jsxs(j,{htmlAttributes:{lang:"en"},children:[e.jsx("link",{rel:"preconnect",href:"https://files.smashing.media"}),e.jsx("link",{rel:"dns-prefetch",href:"https://files.smashing.media"}),e.jsx("link",{rel:"preload",as:"image",href:i.image,fetchpriority:"high"}),e.jsx("title",{children:i.title}),e.jsx("meta",{name:"description",content:i.description}),e.jsx("link",{rel:"canonical",href:g?t.link:i.url})]}),g&&e.jsx(j,{children:e.jsx("script",{type:"application/ld+json",children:JSON.stringify({"@context":"https://schema.org","@type":"Article",headline:t.title,description:i.description,image:i.image,mainEntityOfPage:{"@type":"WebPage","@id":i.url},isBasedOn:t.link,publisher:{"@type":"Organization",name:t.source}})})}),e.jsxs("article",{className:"max-w-4xl mx-auto px-4 py-10",children:[e.jsxs("nav",{className:"mb-6 text-sm opacity-70 flex gap-2",children:[e.jsx(p,{to:"/",className:"hover:underline",children:"UI / UX Blog"}),e.jsx("span",{children:"→"}),e.jsx("span",{className:"opacity-50",children:t.title})]}),e.jsx("h1",{className:"text-3xl font-bold mb-6",children:t.title}),e.jsxs("div",{className:"relative mb-10",children:[e.jsx("img",{src:i.image,alt:t.title,className:"w-full h-80 object-cover rounded-2xl pointer-events-none",loading:"eager",decoding:"async",fetchpriority:"high",onError:s=>s.currentTarget.src=b}),x&&e.jsx(p,{to:`/article/${x.slug}`,state:{article:x,allArticles:a},className:"absolute left-4 top-1/2 -translate-y-1/2 bg-black/60 text-white w-10 h-10 flex items-center justify-center rounded-full",children:"←"}),h&&e.jsx(p,{to:`/article/${h.slug}`,state:{article:h,allArticles:a},className:"absolute right-4 top-1/2 -translate-y-1/2 bg-black/60 text-white w-10 h-10 flex items-center justify-center rounded-full",children:"→"})]}),e.jsx("div",{className:"prose max-w-none mb-12",children:g?e.jsxs(e.Fragment,{children:[t.excerpt&&e.jsx("p",{children:t.excerpt}),e.jsx("a",{href:t.link,target:"_blank",rel:"noopener noreferrer nofollow",className:"inline-block mt-6 px-5 py-2 rounded-lg bg-violet-600 text-white hover:bg-violet-700 transition",children:"Citește articolul original →"})]}):e.jsx("div",{dangerouslySetInnerHTML:{__html:t.content||t.html}})}),e.jsxs("div",{className:"mb-14",children:[e.jsx("p",{className:"font-semibold mb-2",children:"Rating articol:"}),e.jsx(w,{value:v,onRate:s=>{m(s),f.post(`${u}/ratings`,{slug:l,rating:s})},size:"text-xl"})]}),e.jsx(R,{slug:t.slug,isAdmin:y})]})]})}export{_ as default};
